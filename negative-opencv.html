
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet/less" type="text/css" href="./theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="./theme/pygments/native.min.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">


    <link href="https://andrefellipe.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Andre Fellipe Atom">




    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Andre Fellipe da Silva" />
<meta name="description" content="An application that changes pixels values in an image using the OpenCV library. This post was written to the sound of U2&#39;s War. You can listen one of the songs here." />
<meta name="keywords" content="java, swing, opencv, dip">

<meta property="og:site_name" content="Andre Fellipe"/>
<meta property="og:title" content="Negative andre"/>
<meta property="og:description" content="An application that changes pixels values in an image using the OpenCV library. This post was written to the sound of U2&#39;s War. You can listen one of the songs here."/>
<meta property="og:locale" content="en_US.utf8"/>
<meta property="og:url" content="./negative-opencv.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-10-21 18:23:00-03:00"/>
<meta property="article:modified_time" content="2018-10-21 18:23:00-03:00"/>
<meta property="article:author" content="./author/andre-fellipe-da-silva.html">
<meta property="article:section" content="digital image processing"/>
<meta property="article:tag" content="java"/>
<meta property="article:tag" content="swing"/>
<meta property="article:tag" content="opencv"/>
<meta property="article:tag" content="dip"/>
<meta property="og:image" content="https://andrefellipe.com/images/badge.jpeg">

  <title>Andre Fellipe &ndash; Negative andre</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="https://andrefellipe.com/images/badge.jpeg" alt="Andre Fellipe" title="Andre Fellipe">
      </a>
      <h1><a href=".">Andre Fellipe</a></h1>

<p>made on the internet</p>
      <nav>
        <ul class="list">
          <li><a href="./pages/about.html">About</a></li>
          <li><a href="./pages/contact.html">Contact</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/andrefellipe/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/andrefellipe/" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-envelope-o" href="mailto:andrefellipern@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href=".">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>

      <a href="https://andrefellipe.com/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="negative-opencv">Negative andre</h1>
    <p>
          Posted on Oct 21, 2018 in <a href="./category/digital-image-processing.html">digital image processing</a>


    </p>
  </header>


  <div>
    <p>Good news, everyone: I'm running again. I've restarted yesterday and I hope to continue for a long time. It's been a while, so I'm taking it easy.</p>
<p>With this great news in mind, let's talk about how we can work with pixels using the OpenCV library. Today's application is called <strong>Playing with Pixels</strong>. Here's what the user can do with it:</p>
<ul class="simple">
<li>Open an image from his file system;</li>
<li>Choose a region or the whole image to apply operations;</li>
<li>Change all of the pixels of the selected region to black;</li>
<li>Change all of the pixels of the selected region to red;</li>
<li>Change all of the pixels of the selected region to its color's complement;</li>
<li>Restore the original image;</li>
<li>Save a new image with one of the operations applied.</li>
</ul>
<p>You can see the <strong>Playing with Pixels</strong> application in action below:</p>
<img alt="Animated .gif that shows the user opening an image, changing it to black, then to red, then to its negative, then restoring back to the original. Then, the user applies the negative to only one area and saves the new image." class="align-center" src="images/04-01-PlayingWithPixelsDemo.gif" />
<p>Wow! There's a lot of noise in this <strong>.gif</strong>.</p>
<p>Anyway, in this post, I won't explain everything step-by-step like previously. You can take a look at this <a class="reference external" href="https://github.com/andrefellipe/dip/blob/master/src/Exercise02.java">link</a> to see how I've created the user interface. To make things shorter, I will only explain parts of the most important methods.</p>
<div class="section" id="determining-the-region-of-interest">
<h2>Determining the Region of Interest</h2>
<p>A region of interest (ROI) is a part of an image that we want to operate on. We can use any polygon to create ROIs. Here, we're using a rectangle. The user can choose the coordinates of the first point, the upper-left corner of the rectangle, and of the second point, the lower-right corner of the rectangle. If the user doesn't want to choose the points, the full image will compose our ROI. The radio buttons on the interface inform us what the user wants.</p>
<p>Also, to make it a more smooth user experience, we validate the user's input in the fields to make sure that he has chosen a valid positive integer (the <strong>getValueFromField()</strong> method is responsible for this) and that this number is a valid pixel of the image (you can't choose the pixel in row 3000 and column 2000 if the image's resolution is 500x500).</p>
<p>Let's take a look at the code that does what was described:</p>
<div class="highlight"><pre><span></span>  <span class="cm">/**</span>
<span class="cm">   * Method that detects the button pressed by the user and performs</span>
<span class="cm">   * the appropriate operation.</span>
<span class="cm">   */</span>
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">operationsButtonActionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>

    <span class="cm">/** Creating a full copy of the original image and storing it at</span>
<span class="cm">     *  another Mat object to keep the original unaltered. */</span>
    <span class="n">currentImage</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span>

    <span class="cm">/** Checking which option the user chose in relation to where to</span>
<span class="cm">     *  apply the operation. If it&#39;s in the full image, then the first</span>
<span class="cm">     *  vertice of the rectangle that defines the region should be at the</span>
<span class="cm">     *  origin of the image and the second vertices at the last pixel, whose</span>
<span class="cm">     *  position is equal to the number of columns and rows that the image has.</span>
<span class="cm">     *  Else, if the user chose to insert himself the region of interest,</span>
<span class="cm">     *  the application must get the value from the fields and define the points</span>
<span class="cm">     *  accordingly.</span>
<span class="cm">     */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fullImageChosen</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">firstPointX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="n">firstPointY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="n">secondPointX</span> <span class="o">=</span> <span class="n">currentImage</span><span class="p">.</span><span class="na">cols</span><span class="p">();</span>
      <span class="n">secondPointY</span> <span class="o">=</span> <span class="n">currentImage</span><span class="p">.</span><span class="na">rows</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">firstPointX</span> <span class="o">=</span> <span class="n">getValueFromField</span><span class="p">(</span><span class="n">firstPointXField</span><span class="p">);</span>
      <span class="n">firstPointY</span> <span class="o">=</span> <span class="n">getValueFromField</span><span class="p">(</span><span class="n">firstPointYField</span><span class="p">);</span>
      <span class="n">secondPointX</span> <span class="o">=</span> <span class="n">getValueFromField</span><span class="p">(</span><span class="n">secondPointXField</span><span class="p">);</span>
      <span class="n">secondPointY</span> <span class="o">=</span> <span class="n">getValueFromField</span><span class="p">(</span><span class="n">secondPointYField</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Creating the points according to the choice made by the user.</span>
<span class="cm">     */</span>
    <span class="n">firstPoint</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">firstPointX</span><span class="p">,</span> <span class="n">firstPointY</span><span class="p">);</span>
    <span class="n">secondPoint</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">secondPointX</span><span class="p">,</span> <span class="n">secondPointY</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Checking if the user chose a value outside of the image, something</span>
<span class="cm">     * that is not acceptable. If the user chose a value beyond the image&#39;s</span>
<span class="cm">     * height or width, then this value is readjusted to the image&#39;s border value.</span>
<span class="cm">     */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">firstPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">()</span> <span class="o">||</span> <span class="n">firstPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">()</span>
        <span class="o">||</span> <span class="n">secondPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">()</span> <span class="o">||</span> <span class="n">secondPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">())</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">firstPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">firstPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">();</span>
        <span class="n">firstPointXField</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">firstPoint</span><span class="p">.</span><span class="na">x</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">firstPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">firstPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">();</span>
        <span class="n">firstPointYField</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">firstPoint</span><span class="p">.</span><span class="na">y</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">secondPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">secondPoint</span><span class="p">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">width</span><span class="p">();</span>
        <span class="n">secondPointXField</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">secondPoint</span><span class="p">.</span><span class="na">x</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">secondPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">&gt;</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">secondPoint</span><span class="p">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">.</span><span class="na">height</span><span class="p">();</span>
        <span class="n">secondPointYField</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span> <span class="n">secondPoint</span><span class="p">.</span><span class="na">y</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
<p>Our rectangle is created with the help from an object from the <a class="reference external" href="https://docs.opencv.org/3.4/javadoc/org/opencv/core/Rect.html">Rect</a> class. We use its constructor to create a rectangle with the vertices defined by the chosen two points.</p>
<p>To get our ROI, we create a new object from the <strong>Mat</strong> class, <strong>roiMat</strong>. This object is created by using a <a class="reference external" href="https://docs.opencv.org/3.4/javadoc/org/opencv/core/Mat.html#Mat-org.opencv.core.Mat-org.opencv.core.Rect-">constructor</a> from the <strong>Mat</strong> class that allows us to pass a <strong>Mat</strong> object and a <strong>Rect</strong> object. The result is only the content from the <strong>Mat</strong> that resides in the area defined by the <strong>Rect</strong>. If the chosen points were (0,0) and (10,10), our <strong>roiMat</strong> would be a 10x10 square with the content of the original image from this exact area.</p>
<p>As we did previously, we need to pass the content from the ROI to a byte array, our good old <strong>buffer</strong>, a process that we've seen here before.</p>
<p>The following code creates our ROI and pass its content to our <strong>buffer</strong>:</p>
<div class="highlight"><pre><span></span>    <span class="cm">/**</span>
<span class="cm">     * Creating a Mat object with the region of interest chosen by the user.</span>
<span class="cm">     */</span>
    <span class="n">Mat</span> <span class="n">roiMat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mat</span><span class="p">(</span><span class="n">currentImage</span><span class="p">,</span> <span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">firstPoint</span><span class="p">,</span> <span class="n">secondPoint</span><span class="p">));</span>

    <span class="cm">/** We need to create a byte array that will store the matImage contents.</span>
<span class="cm">     *  We find the size of this array through the number of elements in the</span>
<span class="cm">     *  Mat object. */</span>
    <span class="kt">int</span> <span class="n">bufferSize</span> <span class="o">=</span> <span class="n">roiMat</span><span class="p">.</span><span class="na">channels</span><span class="p">()</span> <span class="o">*</span> <span class="n">roiMat</span><span class="p">.</span><span class="na">cols</span><span class="p">()</span> <span class="o">*</span> <span class="n">roiMat</span><span class="p">.</span><span class="na">rows</span><span class="p">();</span>

    <span class="cm">/** Creating the byte array. */</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">bufferSize</span><span class="o">]</span><span class="p">;</span>

    <span class="cm">/** Using the get() method to put all of the elements of the region of interest</span>
<span class="cm">     *  inside the byte array. */</span>
    <span class="n">roiMat</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="changing-the-pixels-of-the-roi">
<h2>Changing the pixels of the ROI</h2>
<p>In our application, we store the information about which button the user clicked with the <strong>buttonChosen</strong> <strong>String</strong> and use it as the key to a <strong>switch</strong> statement to determine what should be done. If the user wants to show it back the original image, we only need to assign our <strong>currentImage</strong> <strong>Mat</strong> object to the <strong>originalImage</strong> object that we made sure it wasn't going to be altered in any circumstance. In the other cases, we need to alter the pixels in our buffer and then put it back in the <strong>roiMat</strong> before showing it again on the screen.</p>
<p>To alter the pixels, we can use one of the two helper methods: <strong>changePixelsColor()</strong> and <strong>changePixelsToNegative()</strong>. The first one will be used if we want to change the <strong>roiMat</strong> pixels to a single color (in this case, black or red). The second one will be used if we want the find the negative of the ROI.</p>
<p>This piece of the puzzle can be seen here:</p>
<div class="highlight"><pre><span></span>    <span class="cm">/** Creating a String variable to know which button was clicked. */</span>
    <span class="n">String</span> <span class="n">buttonChosen</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="na">getActionCommand</span><span class="p">();</span>

    <span class="cm">/**</span>
<span class="cm">     *  Using a switch statement to control what should be done based</span>
<span class="cm">     *  on which button the user clicked.</span>
<span class="cm">     *  If the user chose the black pixels option, we must change the</span>
<span class="cm">     *  chosen pixels to the color black throught the call of the</span>
<span class="cm">     *  changePixelsColors() method. The same in case of the red pixels</span>
<span class="cm">     *  option, but using the color red.</span>
<span class="cm">     *  If the user chose the negative option, we change the chosen pixels</span>
<span class="cm">     *  using the calculatePixelNegative() method.</span>
<span class="cm">     *  If the user chose the restore option, we only need to get the original</span>
<span class="cm">     *  pixels.</span>
<span class="cm">     */</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">buttonChosen</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s">&quot;Black Pixels&quot;</span><span class="p">:</span>
      <span class="n">changePixelsColor</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">bufferSize</span><span class="p">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">});</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s">&quot;Red Pixels&quot;</span><span class="p">:</span>
      <span class="n">changePixelsColor</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">bufferSize</span><span class="p">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">});</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s">&quot;Negative Pixels&quot;</span><span class="p">:</span>
      <span class="n">changePixelsToNegative</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">bufferSize</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s">&quot;Restore Original Image&quot;</span><span class="p">:</span>
      <span class="n">currentImage</span> <span class="o">=</span> <span class="n">originalImage</span><span class="p">;</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Putting the newly calculated pixels values on the region of</span>
<span class="cm">     * interest with the put() method.</span>
<span class="cm">     */</span>
    <span class="n">roiMat</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Calling the showImage() method the display the new image on</span>
<span class="cm">     * the screen.</span>
<span class="cm">     */</span>
</pre></div>
</div>
<div class="section" id="the-java-unsigned-problem">
<h2>The Java unsigned problem</h2>
<p>If you've worked with Java before, you should know that this programming language doesn't have an unsigned data type. For instance, a <a class="reference external" href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html">byte</a> data type is an <strong>8-bit</strong> signed two's complement integer. It can represent a number from <strong>-128 to 127</strong>. If we're working with <strong>8-bit</strong> images and representing the values in a byte array, how are we going to put the value <strong>200</strong> if a byte in Java can't represent this number?</p>
<p>The answer isn't so trivial, but it's a simple one.</p>
<p>First, we're going to take our byte and use the <strong>AND</strong> operator with the number <strong>0xff</strong>. <strong>0xff</strong> is the hexadecimal <strong>FF</strong>, which is an integer of value <strong>255</strong>. Its binary representation is <strong>00000000000000000000000011111111</strong>, a <strong>32-bit</strong> integer (int data type in Java). When we do this, we have a <strong>32-bit</strong> number where the last <strong>8</strong> bits are our desired value and the rest is <strong>0</strong>. This means that we can do operations between integers and cast it back to a byte to put it in the array.</p>
</div>
<div class="section" id="changing-the-values-in-the-buffer">
<h2>Changing the values in the buffer</h2>
<p>In the case of the <strong>changePixelsColor()</strong>, this method receives an int array of length three where each position represents the value from each channel. The first position contains the blue channel, the second has the green channel and the third has the red channel. If we want the color red, we pass it <strong>new int[] {0, 0, 255}</strong>.</p>
<p>Inside the method, we iterate through the <strong>buffer</strong> and put the values of the desired color in the channels. To change it to a black pixel value, we pass <strong>new int[] {0, 0, 0}</strong>. For green? <strong>new int[] {0, 255, 0}</strong>. For a color that I don't know? <strong>new int[] {31, 200, 109}</strong>.</p>
<p>The <strong>changePixelsToNegative()</strong> method is a little different, but not much. The negative color of a color is its complementary color.</p>
<p>Wow, that's a lot of colors.</p>
<p>Don't worry! This value is the distance between the color value and <strong>255</strong>. In this case, we need to get the current value in the <strong>buffer</strong>, find the distance to <strong>255</strong> and replace the value in the <strong>buffer</strong>.</p>
<p>Here's the code:</p>
<div class="highlight"><pre><span></span>  <span class="cm">/**</span>
<span class="cm">   * Helper method to calculate the negative complement of each value in each</span>
<span class="cm">   * channel on every pixel in the region of interest. Since Java does not have</span>
<span class="cm">   * any unsigned byte data type, we must cast the value to an int using the AND</span>
<span class="cm">   * operator with 0xff, find the complement (distance from the number to 255) and</span>
<span class="cm">   * cast the result to a byte type.</span>
<span class="cm">   * @param buffer - byte array with the values of the pixels from an image.</span>
<span class="cm">   * @param bufferSize - size of the byte array.</span>
<span class="cm">   */</span>
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">changePixelsToNegative</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bufferSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="na">abs</span><span class="p">((</span><span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">255</span><span class="p">));</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="na">abs</span><span class="p">((</span><span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">255</span><span class="p">));</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="na">abs</span><span class="p">((</span><span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">255</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * Helper method to change the pixel value of each value in each channel on every</span>
<span class="cm">   * pixel in the region of interest. Here, we must pass an array of lenght three with</span>
<span class="cm">   * the new pixel value. Since Java does not have any unsigned byte data type, we must pass</span>
<span class="cm">   * an int array and use the AND operator with 0xff, then cast it to a byte type.</span>
<span class="cm">   * @param buffer - byte array with the values of the pixels from an image.</span>
<span class="cm">   * @param bufferSize - size of the byte array.</span>
<span class="cm">   * @param newPixelValue - array with the values of each channel of the new color</span>
<span class="cm">   * that should be put in place of the current one, respecting the BGR model. It must be</span>
<span class="cm">   * an array of lenght three, where the number in the first position represent the blue</span>
<span class="cm">   * channel, the one in the second position represent the green channel and the third position</span>
<span class="cm">   * represents the red color.</span>
<span class="cm">   */</span>
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">changePixelsColor</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bufferSize</span><span class="p">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">newPixelValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bufferSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">newPixelValue</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">newPixelValue</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
        <span class="n">buffer</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">newPixelValue</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
<p>And I guess that's it! I hope that you've enjoyed today's post. Before I go, let's just see what color is <strong>new int[] {31, 200, 109}</strong>:</p>
<img alt="Picture of andre's face with a rectangle kind of green in front. This green is the random color from the text." class="align-center" src="images/04-02-PlayingWithPixelsRandom.png" />
<p>Awesome!</p>
</div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/java.html">java</a>
      <a href="./tag/swing.html">swing</a>
      <a href="./tag/opencv.html">opencv</a>
      <a href="./tag/dip.html">dip</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>


    <div class="addthis_relatedposts_inline"></div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'andrefellipe';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy;  2018 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>


    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5ba05ddbeb328e87" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Andre Fellipe ",
  "url" : ".",
  "image": "https://andrefellipe.com/images/badge.jpeg",
  "description": "Andre's personal site"
}
</script>

</body>
</html>